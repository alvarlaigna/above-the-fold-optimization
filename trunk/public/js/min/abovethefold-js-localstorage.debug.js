!function(e,r){try{if(!("localStorage"in e&&null!==e.localStorage))return}catch(e){return}if(void 0!==e.Worker&&e.Worker){var t=[],o="requestIdleCallback"in e&&null!==e.requestIdleCallback&&e.requestIdleCallback,n=function(r){"Promise"in e?new Promise(function(e,t){e(r())}):"undefined"!==e.setImmediate?e.setImmediate(r):setTimeout(r,0)},i={prefix:"abtf-",default_expire:86400,preloaded:{},now:function(){return+new Date/1e3},execWhenIdle:function(e,r){o?o(e,{timeout:r}):e()},saveScript:function(e,r,t){i.execWhenIdle(function(){var o={},n=i.now();if(o.date=n,o.expire=n+(t||i.default_expire),r instanceof Array){o.chunked=!0,o.chunks=r.length;for(var a=[],s=r.length,l=0;l<s;l++)a.push(r[l])}else{a=!1;o.data=r}if(i.add(e,o),a)for(var s=a.length,l=0;l<s;l++)i.add("chunk:"+l+":"+e,a[l])},3e3)},getScript:function(e){if(void 0!==i.preloaded[e]&&!1!==i.preloaded[e])return i.preloaded[e];i.preloaded[e]=!1;var n=i.get(e);if(!n)return!1;if(void 0!==n.expire&&n.expire-i.now()<0)return!1;if(void 0!==n.chunked&&!0===n.chunked){for(var s,l=[],c=0;c<n.chunks;c++){if(!1===(s=i.get("chunk:"+c+":"+e)))return!1;l.push(s)}n.data=l.join("")}var f,u="/* Above The Fold Optimization HTML5 Script Loader\n * @url "+e+" */\n",d=!1;if(o&&void 0!==r.js[2]&&r.js[2])for(var p=r.js[2].length,c=0;c<p;c++)if("object"==typeof r.js[2][c]&&-1!==e.indexOf(r.js[2][c][0])){d=!0,r.js[2][c][1]&&(f=r.js[2][c][1]);break}return d?(u+="window.requestIdleCallback(function(){",u+=n.data,u+=f?"},{timeout:"+f+"});":"});"):u+=n.data,i.preloaded[e]=a(u,"application/javascript"),t.push(i.preloaded[e]),i.preloaded[e]},preloadScript:function(e){void 0===i.preloaded[e]&&i.execWhenIdle(function(){void 0===i.preloaded[e]&&(i.preloaded[e]=i.getScript(e))},100)},add:function(e,r,t){if(void 0!==t&&parseInt(t)>10)console.error("Abtf.js() ➤ localStorage quota reached","retry limit reached, abort saving...",e);else{"object"==typeof r&&(r=JSON.stringify(r));try{return localStorage.setItem(i.prefix+e,r),!0}catch(l){if(l.name.toUpperCase().indexOf("QUOTA")>=0){var o,n,a,s=[];for(o in localStorage)0===o.indexOf(i.prefix)&&-1===o.indexOf("chunk:")&&(a=o.split(i.prefix)[1],(n=i.get(a))&&s.push([a,n]));return s.length?(s.sort(function(e,r){return e[1].date-r[1].date}),console.error("Abtf.js() ➤ localStorage quota reached","removed",s[0][0],"for key",e),i.remove(s[0][0]),void i.execWhenIdle(function(){void 0===t&&(t=0),i.add(e,r,++t)},1e3)):void console.error("Abtf.js() ➤ localStorage quota reached","no files to remove")}return void console.error("Abtf.js() ➤ localStorage error",l.name,l)}}},remove:function(e){var r=i.get(e);if(r){if(r.chunked)for(var t=parseInt(r.chunks),o=0;o<t;o++)localStorage.removeItem(i.prefix+"chunk:"+o+":"+e);localStorage.removeItem(i.prefix+e)}},get:function(e){var r=localStorage.getItem(i.prefix+e);try{return-1!==e.indexOf("chunk:")?r||!1:JSON.parse(r||"false")}catch(e){return!1}},clear:function(e){var r,t,o,n=this.now(),a=[];for(r in localStorage)if(t=r.split(i.prefix)[1]){if(-1!==t.indexOf("chunk:"))continue;if(!(o=i.get(t)))continue;(!e||o.expire<=n)&&(i.remove(t),a.push(t))}a.length>0&&console.warn("Abtf.js() ➤ localStorage cleared",a.length,"expired scripts")}},a=function(r,t){var o;try{o=new Blob([r],{type:t})}catch(n){e.BlobBuilder=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder,(o=new BlobBuilder).append(r),o=o.getBlob(t)}return URL.createObjectURL(o)},s=function(){self.FETCH=self.fetch||!1,self.DEFAULT_TIMEOUT=5e3,self.MAX_CHUNK_SIZE=1e5,self.CHUNK_DATA=function(e,r){for(var t,o=Math.ceil(e.length/r),n=new Array(o),i=0;i<o;i++)t=i*r,n[i]=e.substring(t,t+r);return n},self.LOAD_RESOURCE=function(e){var r=!1,t=!1,o=function(o,n){r||(r=!0,t&&(clearTimeout(t),t=!1),!o&&n&&n.length>self.MAX_CHUNK_SIZE&&(n=self.CHUNK_DATA(n,self.MAX_CHUNK_SIZE)),self.RESOURCE_LOAD_COMPLETED(e,o,n))};if(self.FETCH){var n={method:"GET",mode:"cors",cache:"default"},i=function(e){r||("object"==typeof e&&e.status&&(e=[e.status,e.statusText]),o(e))};self.FETCH(e.url,n).then(function(e){r||(e.ok?e.text().then(function(e){o(!1,e)}):o([e.status,e.statusText]))},i).catch(i);s=e.timeout||self.DEFAULT_TIMEOUT;isNaN(s)&&(s=self.DEFAULT_TIMEOUT),t=setTimeout(function(){r||o("timeout")},s)}else{var a=new XMLHttpRequest;a.open("GET",e.url,!0),a.responseType="text",a.onreadystatechange=function(){r||4===a.readyState&&(200!==a.status?o(a.statusText):o(!1,a.responseText))},a.onerror=function(){r||o(a.statusText)};var s=e.timeout||self.DEFAULT_TIMEOUT;isNaN(s)&&(s=self.DEFAULT_TIMEOUT),t=setTimeout(function(){if(!r){try{a.abort()}catch(e){}o("timeout")}},s),a.send(null)}},self.RESOURCE_LOAD_COMPLETED=function(e,r,t){r?(r instanceof Array||"object"!=typeof r||(r=r.toString()),self.postMessage([2,e.i,r])):self.postMessage([1,e.i,t])},self.onmessage=function(e){var r=e.data;if(r instanceof Array)for(var t=r.length,o=0;o<t;o++)"object"==typeof r[o]&&void 0!==r[o].url&&void 0!==r[o].i&&self.LOAD_RESOURCE(r[o]);else{if("object"!=typeof r||void 0===r.url||void 0===r.i)throw new Error("Web Worker Script Loader: Invalid resource object");self.LOAD_RESOURCE(r)}}}.toString().replace(/^function\s*\(\s*\)\s*\{/,"").replace(/\}$/,""),l={workerUri:a(s,"application/javascript"),worker:!1,scriptIndex:0,scriptQueue:[],start:function(){this.worker=new Worker(this.workerUri),this.worker.addEventListener("message",this.handleMessage),this.worker.addEventListener("error",this.handleError)},stop:function(){this.worker&&(this.worker.removeEventListener("message",this.handleMessage),this.worker.removeEventListener("error",this.handleError),this.worker.terminate(),this.worker=!1,console.warn("Abtf.js() ➤ web worker terminated"))},handleMessage:function(e){var r=e.data,t=r[1];if(void 0!==l.scriptQueue[t]){if(1!==parseInt(r[0]))return 2===parseInt(r[0])?r[2]instanceof Array&&parseInt(r[2][0])>200&&parseInt(r[2][0])<600?void console.error("Abtf.js() ➤ web worker ➤ "+r[2][0]+" "+r[2][1],l.scriptQueue[t].url):void console.error("Abtf.js() ➤ web worker script loader error",r[2]):void 0;l.scriptQueue[t].onData(r[2])}else console.error("Abtf.js() ➤ web worker script loader invalid response",r)},handleError:function(e){console.error("Abtf.js() ➤ web worker script loader error",e)},loadScript:function(e,t){this.worker||this.start(),e=r.pxs(e);var o=parseInt(this.scriptIndex);this.scriptIndex++,this.scriptQueue[o]={url:e,onData:t},this.worker.postMessage({url:e,i:o})}};if(l.start(),e.addEventListener("beforeunload",function(e){if(l.stop(),t.length>0)for(var r=t.length,o=0;o<r;o++)try{URL.revokeObjectURL(t[o])}catch(e){console.error("Abtf.js() ➤ failed to revoke script url",t[o],e)}}),o)o(function(){i.clear(!0)},{timeout:3e3});else{var c,f=function(){c&&clearTimeout(c),c=setTimeout(function(){i.clear(!0)},2e3)};f(),r.osl(f)}r.lcs=function(e,t,o){n(function(){var n=i.getScript(e);if(n)return o(n),void r.ls(n,t);o(!1),r.ls(e,function(){t(),l.loadScript(e,function(t){t?(t instanceof Array?console.info("Abtf.js() ➤ web worker ➤ localStorage saved chunked","("+t.length+" chunks)",r.localUrl(e)):console.info("Abtf.js() ➤ web worker ➤ localStorage saved","("+t.length+")",r.localUrl(e)),i.saveScript(e,t)):console.error("Abtf.js() ➤ web worker script loader no data",r.localUrl(e))})})})},r.pcs=function(e){n(function(){i.preloadScript(e)})},r.csu=function(e){var t=i.getScript(e);return t||(l.loadScript(e,function(t){t?(t instanceof Array?console.info("Abtf.js() ➤ web worker ➤ localStorage saved chunked","("+t.length+" chunks)",r.localUrl(e)):console.info("Abtf.js() ➤ web worker ➤ localStorage saved","("+t.length+")",r.localUrl(e)),i.saveScript(e,t)):console.error("Abtf.js() ➤ web worker script loader no data",r.localUrl(e))}),e)}}}(window,window.Abtf);